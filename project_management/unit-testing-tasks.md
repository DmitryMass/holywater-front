# Задачі по Unit-тестуванню JSON створення для відправки на сервер

## 1. Налаштування Jest та конфігурації тестування

### 1.1 Встановлення та налаштування Jest

- [x] Встановити Jest та необхідні залежності:
  ```bash
  npm install --save-dev jest @types/jest ts-jest jest-environment-jsdom
  npm install --save-dev @testing-library/react @testing-library/jest-dom
  npm install --save-dev @testing-library/user-event
  ```

### 1.2 Конфігурація Jest

- [x] Створити `jest.config.js` з налаштуваннями для TypeScript та React
- [x] Налаштувати підтримку модулів ES6 та алісів шляхів (@/)
- [x] Додати setup файл для Jest DOM

### 1.3 Оновлення package.json

- [x] Додати скрипти тестування:
  ```json
  {
    "scripts": {
      "test": "jest",
      "test:watch": "jest --watch",
      "test:coverage": "jest --coverage",
      "test:ci": "jest --ci --coverage --watchAll=false"
    }
  }
  ```

## 2. Тестування утиліт для створення JSON структур

### 2.1 Тестування функцій створення ScreenConfig

**Файл:** `src/utils/__tests__/screenConfigUtils.test.ts`

- [x] Тест створення базової ScreenConfig структури
- [x] Тест валідації обов'язкових полів (\_id, name, sections, createdAt, updatedAt, isActive, version)
- [x] Тест створення ScreenConfig з різними типами секцій
- [x] Тест серіалізації ScreenConfig в JSON
- [x] Тест десеріалізації JSON в ScreenConfig

### 2.2 Тестування функцій створення Section

**Файл:** `src/utils/__tests__/sectionUtils.test.ts`

- [ ] Тест створення секції типу 'banner'
- [ ] Тест створення секції типу 'horizontalList'
- [ ] Тест створення секції типу 'verticalList'
- [ ] Тест створення секції типу 'grid'
- [ ] Тест створення секції типу 'hero'
- [ ] Тест валідації обов'язкових полів Section (id, type, items)
- [ ] Тест створення Section з налаштуваннями (SectionSettings)
- [ ] Тест серіалізації Section в JSON

### 2.3 Тестування функцій створення Item

**Файл:** `src/utils/__tests__/itemUtils.test.ts`

- [ ] Тест створення Item типу 'image'
- [ ] Тест створення Item типу 'text'
- [ ] Тест створення Item типу 'button'
- [ ] Тест створення Item типу 'product'
- [ ] Тест створення Item типу 'category'
- [ ] Тест валідації обов'язкових полів Item (id, type, content)
- [ ] Тест створення Item з різними CardLayout варіантами
- [ ] Тест серіалізації Item в JSON

## 3. Тестування хуків для роботи з JSON

### 3.1 Тестування useScreenConfig хука

**Файл:** `src/hooks/__tests__/useScreenConfig.test.ts`

- [x] Тест ініціалізації хука з порожньою конфігурацією
- [x] Тест ініціалізації хука з існуючою конфігурацією
- [x] Тест методу `getJsonRepresentation()` для порожньої конфігурації
- [x] Тест методу `getJsonRepresentation()` для повної конфігурації
- [x] Тест додавання секції та перевірка JSON виводу
- [x] Тест оновлення секції та перевірка JSON виводу
- [x] Тест видалення секції та перевірка JSON виводу
- [x] Тест додавання елементу та перевірка JSON виводу
- [x] Тест оновлення елементу та перевірка JSON виводу
- [x] Тест видалення елементу та перевірка JSON виводу

### 3.2 Тестування useScreenConfigApi хука

**Файл:** `src/hooks/__tests__/useScreenConfigApi.test.ts`

- [x] Мокування API викликів
- [x] Тест методу `createConfig()` з валідними даними
- [x] Тест методу `updateConfig()` з частковими оновленнями
- [x] Тест ініціалізації хука з порожніми даними
- [x] Тест методу `fetchConfigs()` для успішного завантаження
- [x] Тест методу `fetchConfigs()` для обробки помилок
- [x] Тест методу `fetchConfigById()` для успішного завантаження
- [x] Тест методу `fetchConfigById()` для обробки помилок
- [x] Тест методу `deleteConfig()` для успішного видалення
- [x] Тест методу `deleteConfig()` для обробки помилок
- [x] Тест серіалізації даних перед відправкою на сервер
- [x] Тест обробки помилок при невалідних JSON структурах
- [x] Тест трансформації \_id в id для зворотної сумісності

## 4. Тестування API сервісів

### 4.1 Тестування screenConfigApi

**Файл:** `src/services/api/__tests__/screenConfigApi.test.ts`

- [x] Мокування axios запитів
- [x] Тест `createScreenConfig()` з валідною ScreenConfig структурою
- [x] Тест методу `getScreenConfigs()` для успішного отримання списку
- [x] Тест методу `getScreenConfigs()` для обробки помилок
- [x] Тест методу `getScreenConfigById()` для успішного отримання конфігурації
- [x] Тест методу `getScreenConfigById()` для обробки помилок
- [x] Тест методу `updateScreenConfig()` для успішного оновлення
- [x] Тест методу `updateScreenConfig()` для обробки помилок
- [x] Тест методу `deleteScreenConfig()` для успішного видалення
- [x] Тест методу `deleteScreenConfig()` для обробки помилок
- [x] Тест методу `activateScreenConfig()` для активації конфігурації
- [x] Тест `updateScreenConfig()` з частковими оновленнями
- [x] Тест серіалізації даних перед HTTP запитом
- [x] Тест десеріалізації відповіді сервера
- [x] Тест обробки помилок API
- [x] Тест валідації JSON структури перед відправкою

### 4.2 Тестування трансформації даних

**Файл:** `src/services/api/__tests__/dataTransformation.test.ts`

- [ ] Тест трансформації ScreenConfig для створення (видалення \_id, createdAt, updatedAt)
- [ ] Тест трансформації ScreenConfig для оновлення (часткові дані)
- [ ] Тест валідації JSON структури перед відправкою
- [ ] Тест обробки спеціальних символів в JSON
- [ ] Тест обробки великих JSON структур

## 5. Тестування компонентів для JSON створення

### 5.1 Тестування JsonPreview компонента

**Файл:** `src/components/builder/__tests__/JsonPreview.test.tsx`

- [ ] Тест рендерингу порожнього JSON
- [ ] Тест рендерингу валідного JSON
- [ ] Тест форматування JSON (відступи, переноси рядків)
- [ ] Тест функції копіювання JSON в буфер обміну
- [ ] Тест розгортання/згортання JSON
- [ ] Тест обробки невалідних JSON структур

### 5.2 Тестування PropertyPanel компонента

**Файл:** `src/components/builder/__tests__/PropertyPanel.test.tsx`

- [ ] Тест генерації JSON при зміні властивостей секції
- [ ] Тест генерації JSON при зміні властивостей елементу
- [ ] Тест валідації введених даних перед створенням JSON
- [ ] Тест обробки спеціальних символів у полях

## 6. Інтеграційні тести JSON створення

### 6.1 Тестування повного циклу створення конфігурації

**Файл:** `src/__tests__/integration/screenConfigCreation.test.ts`

- [x] Тест створення повної ScreenConfig з нуля
- [x] Тест додавання різних типів секцій
- [x] Тест додавання різних типів елементів
- [x] Тест серіалізації фінальної структури
- [x] Тест відправки на сервер (мокований)
- [x] Тест отримання відповіді та обробки результату

### 6.2 Тестування валідації JSON структур

**Файл:** `src/__tests__/integration/jsonValidation.test.ts`

- [ ] Тест валідації обов'язкових полів ScreenConfig
- [ ] Тест валідації типів даних у JSON
- [ ] Тест валідації вкладених структур (Section, Item)
- [ ] Тест валідації enum значень (SectionType, ItemType, CardLayout)
- [ ] Тест обробки невалідних JSON структур

## 7. Тести продуктивності JSON операцій

### 7.1 Тестування великих JSON структур

**Файл:** `src/__tests__/performance/largeJsonHandling.test.ts`

- [ ] Тест серіалізації великих ScreenConfig (100+ секцій)
- [ ] Тест десеріалізації великих JSON структур
- [ ] Тест продуктивності `getJsonRepresentation()`
- [ ] Тест пам'яті при роботі з великими JSON

### 7.2 Бенчмарки JSON операцій

**Файл:** `src/__tests__/performance/jsonBenchmarks.test.ts`

- [ ] Бенчмарк швидкості створення ScreenConfig
- [ ] Бенчмарк швидкості серіалізації JSON
- [ ] Бенчмарк швидкості валідації JSON структур
- [ ] Порівняння різних підходів до створення JSON

## 8. Мок дані для тестування

### 8.1 Створення тестових фікстур

**Файл:** `src/__tests__/fixtures/screenConfigFixtures.ts`

- [ ] Мок дані для базової ScreenConfig
- [ ] Мок дані для різних типів секцій
- [ ] Мок дані для різних типів елементів
- [ ] Мок дані для складних конфігурацій
- [ ] Мок дані для невалідних структур

### 8.2 Утиліти для тестування

**Файл:** `src/__tests__/utils/testUtils.ts`

- [ ] Функції для створення тестових ScreenConfig
- [ ] Функції для валідації JSON структур
- [ ] Функції для порівняння JSON об'єктів
- [ ] Функції для генерації випадкових тестових даних

## 9. Налаштування CI/CD для тестів

### 9.1 GitHub Actions конфігурація

- [ ] Налаштування автоматичного запуску тестів при push
- [ ] Налаштування звітів покриття коду
- [ ] Налаштування перевірки якості JSON структур
- [ ] Налаштування performance тестів

### 9.2 Якість коду

- [ ] Налаштування ESLint правил для тестів
- [ ] Налаштування Prettier для тестових файлів
- [ ] Налаштування TypeScript перевірок для тестів

## 10. Документація тестування

### 10.1 README для тестів

**Файл:** `src/__tests__/README.md`

- [ ] Опис структури тестів
- [ ] Інструкції по запуску тестів
- [ ] Опис тестових сценаріїв
- [ ] Приклади використання мок даних

### 10.2 Документація JSON схем

**Файл:** `docs/json-schemas.md`

- [ ] Опис структури ScreenConfig JSON
- [ ] Приклади валідних JSON структур
- [ ] Опис валідації та обмежень
- [ ] Приклади API запитів з JSON

---

## Пріоритетність виконання:

1. **Високий пріоритет:** Розділи 1, 2, 3 (Налаштування Jest, базові утиліти, основні хуки)
2. **Середній пріоритет:** Розділи 4, 5, 6 (API сервіси, компоненти, інтеграційні тести)
3. **Низький пріоритет:** Розділи 7, 8, 9, 10 (Продуктивність, мок дані, CI/CD, документація)

## Критерії готовності:

- [ ] Покриття коду тестами не менше 80%
- [ ] Всі тести проходять успішно
- [ ] Налаштовано автоматичний запуск тестів
- [ ] Створено документацію по тестуванню
- [ ] Налаштовано звіти покриття коду
